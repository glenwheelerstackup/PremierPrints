<script> {% if product.metafields.global.product_type == "personalized_posters" %} window.location.href = "https://"+Shopify.shop+"/apps/editors?editor={{product.metafields.global.editor_url}}&product={{product.id}}"; {% endif %} </script><script>const cart_styles = document.createElement("style"); cart_styles.innerHTML = `.printer_loader { border: 5px solid #f3f3f3; /* Light grey */ border-top: 5px solid #3498db; /* Blue */ border-radius: 50%; width: 30px; height: 30px; animation: spin 1.5s linear infinite; display: block !important; } @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }`; document.querySelector("head").append(cart_styles); const generateDiv = (id) => { const div = document.createElement("div"); div.setAttribute("data-order", id); div.style.cssText = "width: 100px; height: 120px; display: flex; justify-content: center; align-items: center; border: none;"; const loadingDiv = document.createElement("div"); loadingDiv.setAttribute("class", "printer_loader"); div.append(loadingDiv); checkScreenshot(id); return div; }; const checkScreenshot = (id) => { fetch(`https://editor.printerlo.com/public/orders/${id}.png`) .then((resp) => { const img = document.createElement("img"); img.src = `https://editor.printerlo.com/public/orders/${id}.png`; img.setAttribute("width", "50%"); img.setAttribute("height", "100%"); document.querySelector(`[data-order="${id}"]`).innerHTML = ""; document.querySelector(`[data-order="${id}"]`).append(img); document.querySelector( `[data-order="${id}"]` ).style.cssText = ` display: flex; justify-content: start; align-items: center `; }) .catch((err) => { checkScreenshot(id); console.log(err); }); }; const excludesTypes = [ "HTML", "HEAD", "META", "LINK", "TITLE", "SCRIPT", "STYLE", "BODY", "IFRAME", ]; const cart_init = () => { if (window.location.pathname.includes("/cart")) { Array.from(document.querySelectorAll("*")).forEach((elem) => { if ( elem?.innerText?.includes("orderid_") && elem.children.length === 0 && !excludesTypes.includes(elem.nodeName) ) { if (elem.style.display !== "none") { elem.parentNode.insertBefore( generateDiv(elem.innerText.split("_")[1]), elem ); elem.style.display = "none"; } } }); } setInterval(() => { cart_init(); }, 100); }; if(window.location.pathname.includes("/cart")){cart_init();}</script>